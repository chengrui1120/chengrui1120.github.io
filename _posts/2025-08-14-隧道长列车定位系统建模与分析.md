---
title: "隧道长列车定位系统"
header:
  overlay_color: "#333"
categories: 
  - 定位
toc: true
---



## 1. 系统概述

### 1.1 系统架构

隧道长列车定位系统基于漏缆(Leaky Coaxial Cable)技术，采用射线追踪算法进行多径传播建模，实现对长列车的精确定位。

```
隧道环境
├── 物理参数
│   ├── 长度: L = 5000m
│   ├── 直径: D = 8.5m  
│   ├── 截面: 圆形
│   └── 衬砌: 钢筋混凝土
├── 漏缆系统
│   ├── 总长度: 5000m
│   ├── 辐射间隔: Δx = 20m
│   ├── 辐射单元数: N = 250
│   └── 工作频率: f = 900MHz
└── 长列车
    ├── 货运列车: 800m
    ├── 高速列车: 200m
    └── 地铁列车: 120m
```

### 1.2 定位原理

系统通过分析列车上多个接收器接收到的漏缆辐射信号，利用射线追踪算法计算传播路径，结合信号强度和时延信息实现定位。

## 2. 数学建模

### 2.1 坐标系定义

建立隧道坐标系：

- **x轴**: 隧道纵向，原点为隧道入口
- **y轴**: 隧道垂直方向，原点为隧道底部
- **z轴**: 隧道横向，原点为隧道中心线

### 2.2 漏缆辐射模型

#### 2.2.1 辐射单元位置

第i个辐射单元位置：

```
P_i = (x_i, y_c, 0)
其中：
x_i = i × Δx, i = 0, 1, 2, ..., N-1
y_c = 0.1 × H (隧道高度的10%处)
Δx = 20m (辐射间隔)
```

#### 2.2.2 耦合损耗模型

漏缆耦合损耗：

```
L_coupling = L_c + 10log₁₀(d/d₀)

其中：
L_c = 85dB (基准耦合损耗)
d = 漏缆与接收器间距离
d₀ = 1m (参考距离)
```

#### 2.2.3 辐射功率密度

距离漏缆d处的功率密度：

```
S(d) = P_t × G_leak(θ) / (4πd²)

其中：
P_t = 传输功率
G_leak(θ) = 漏缆方向图增益
θ = 辐射角度
```

### 2.3 射线传播模型

#### 2.3.1 自由空间传播损耗

```
L_fs = 20log₁₀(d) + 20log₁₀(f) + 20log₁₀(4π/c) [dB]

其中：
d = 传播距离 [m]
f = 载波频率 = 900MHz
c = 光速 = 3×10⁸ m/s
```

#### 2.3.2 隧道传播损耗

隧道环境额外损耗：

```
L_tunnel = α × d [dB]

其中：
α = 0.05~0.08 dB/m (隧道衰减系数)
d = 传播距离 [m]
```

#### 2.3.3 反射损耗模型

n次反射的总损耗：

```
L_reflection = Σ(i=1 to n) L_r,i

其中：
L_r,concrete = 8dB (混凝土反射损耗)
L_r,metal = 3dB (金属反射损耗)
```

### 2.4 接收信号强度模型

#### 2.4.1 直射路径

从辐射单元P_i到接收器R_j的直射信号：

```
RSSI_direct = P_t - L_coupling - L_fs - L_tunnel [dBm]

其中：
P_t = 发射功率
L_coupling = 漏缆耦合损耗
L_fs = 自由空间损耗  
L_tunnel = 隧道传播损耗
```

#### 2.4.2 反射路径

经过k次反射的信号：

```
RSSI_reflect = P_t - L_coupling - L_fs - L_tunnel - L_reflection - L_multipath [dBm]

其中：
L_multipath = 多径衰落损耗 = 0~10dB (随机)
```

#### 2.4.3 合成信号强度

接收器j处的总信号强度：

```
RSSI_total,j = 10log₁₀(Σ(i=1 to M) 10^(RSSI_i,j/10)) [dBm]

其中：
M = 到达接收器j的射线数量
RSSI_i,j = 第i条射线在接收器j处的信号强度
```

### 2.5 时延计算模型

#### 2.5.1 传播时延

射线传播时延：

```
τ = d/c [s]

其中：
d = 射线总传播距离
c = 电磁波传播速度 ≈ 3×10⁸ m/s
```

#### 2.5.2 多径时延扩散

```
τ_rms = √(Σ(i=1 to M) P_i(τ_i - τ_mean)²/Σ(i=1 to M) P_i) [s]

其中：
P_i = 第i条路径的功率
τ_i = 第i条路径的时延
τ_mean = 平均时延
```

## 3. 定位算法

### 3.1 基于RSSI的定位

#### 3.1.1 距离估计

根据接收信号强度估计距离：

```
d_est = 10^((P_t - RSSI - L_coupling)/20) × λ/(4π) [m]

其中：
λ = c/f = 载波波长
```

#### 3.1.2 最小二乘定位

设列车位置为(x_train, y_train)，建立方程组：

```
(x_train - x_i)² + (y_train - y_i)² = d_i²

i = 1, 2, ..., N (有效辐射单元数)
```

线性化后采用最小二乘求解：

```
[X] = (A^T A)^(-1) A^T [B]

其中：
X = [x_train, y_train]^T
A = 2[x_1-x_N, y_1-y_N; x_2-x_N, y_2-y_N; ...; x_(N-1)-x_N, y_(N-1)-y_N]
B = [d_N²-d_1²+x_1²-x_N²+y_1²-y_N²; ...; d_N²-d_(N-1)²+x_(N-1)²-x_N²+y_(N-1)²-y_N²]
```

### 3.2 基于TDOA的定位

#### 3.2.1 时延差计算

相对于参考辐射单元的时延差：

```
TDOA_i = τ_i - τ_ref [s]

其中：
τ_ref = 参考辐射单元的传播时延
```

#### 3.2.2 双曲线定位

TDOA定位方程：

```
√[(x_train-x_i)² + (y_train-y_i)²] - √[(x_train-x_ref)² + (y_train-y_ref)²] = c × TDOA_i

i = 1, 2, ..., N-1
```

### 3.3 长列车多点定位

#### 3.3.1 接收器布置

沿列车长度L_train均匀布置K个接收器：

```
接收器位置: R_k = x_head - k×(L_train/(K-1)), k = 0, 1, ..., K-1

其中：
x_head = 列车车头位置
L_train = 列车总长度
```

#### 3.3.2 车头车尾定位

分别对车头和车尾接收器进行定位：

```
车头位置: (x_head, y_head) = Position(RSSI_head[], TDOA_head[])
车尾位置: (x_tail, y_tail) = Position(RSSI_tail[], TDOA_tail[])

列车中心位置: x_center = (x_head + x_tail)/2
列车姿态角: θ = arctan((y_head - y_tail)/(x_head - x_tail))
```

## 4. 精度分析

### 4.1 几何精度因子(GDOP)

#### 4.1.1 GDOP计算

```
GDOP = √trace((A^T A)^(-1))

其中：
A = [cosθ_1, sinθ_1; cosθ_2, sinθ_2; ...; cosθ_N, sinθ_N]
θ_i = 从定位点到第i个辐射单元的方位角
```

#### 4.1.2 最优几何配置

最小GDOP条件：

- 辐射单元围绕列车均匀分布
- 避免共线配置
- 距离适中(50m~200m)

### 4.2 测距误差分析

#### 4.2.1 RSSI测距误差

```
σ_RSSI = (σ_shadow × ln(10))/(20 × ln(10)) × d [m]

其中：
σ_shadow = 阴影衰落标准差 = 3~8dB
d = 测距距离
```

#### 4.2.2 TDOA测距误差

```
σ_TDOA = c × σ_τ [m]

其中：
σ_τ = 时延测量误差 = 10~50ns
c = 光速
```

### 4.3 定位误差传播

#### 4.3.1 协方差矩阵

定位误差协方差矩阵：

```
Cov_pos = σ_range² × (A^T A)^(-1)

其中：
σ_range² = 测距误差方差
```

#### 4.3.2 圆概率误差(CEP)

50%概率误差圆半径：

```
CEP = 0.59 × (σ_x + σ_y) [m]

其中：
σ_x, σ_y = x, y方向定位标准差
```

### 4.4 长列车定位精度模型

#### 4.4.1 车头定位精度

```
σ_head = √(GDOP_head² × σ_range²) [m]
```

#### 4.4.2 车尾定位精度

```
σ_tail = √(GDOP_tail² × σ_range² + σ_length²) [m]

其中：
σ_length = 列车长度测量误差
```

#### 4.4.3 整体定位精度

```
σ_overall = √((σ_head² + σ_tail²)/2) [m]
```

## 5. 系统性能分析

### 5.1 覆盖性能

#### 5.1.1 信号覆盖率

```
Coverage = (L_covered/L_total) × 100%

其中：
L_covered = RSSI ≥ -95dBm的隧道长度
L_total = 隧道总长度
```

#### 5.1.2 盲区分析

信号盲区判断条件：

```
RSSI_max < -100dBm 或 有效射线数 < 3
```

### 5.2 定位可用性

#### 5.2.1 可用性定义

```
Availability = (T_available/T_total) × 100%

其中：
T_available = 定位精度满足要求的时间
T_total = 总运行时间
```

#### 5.2.2 可用性要求

- 定位误差 < 5m: 可用性 ≥ 95%
- 定位误差 < 2m: 可用性 ≥ 85%
- 数据更新率 ≥ 10Hz

### 5.3 系统容量

#### 5.3.1 同时定位能力

```
N_trains = min(N_channels, N_time_slots)

其中：
N_channels = 可用频道数
N_time_slots = 时分复用时隙数
```

#### 5.3.2 数据吞吐量

```
Throughput = N_trains × Update_rate × Data_size [bps]

其中：
Update_rate = 位置更新频率
Data_size = 单次位置数据大小
```

## 6. 误差源分析

### 6.1 系统误差

#### 6.1.1 漏缆参数误差

- 耦合损耗变化: ±2dB
- 辐射单元位置偏差: ±0.5m
- 频率偏移影响: ±1dB

#### 6.1.2 传播模型误差

- 隧道几何建模误差: ±10%
- 材料参数不确定性: ±5dB
- 温湿度影响: ±1~3dB

### 6.2 随机误差

#### 6.2.1 多径衰落

```
σ_multipath = 2~8dB (Rayleigh分布)
```

#### 6.2.2 噪声影响

```
SNR = RSSI - Noise_floor
Noise_floor = -174dBm + 10log₁₀(B) + NF

其中：
B = 信号带宽
NF = 接收机噪声系数
```

### 6.3 环境误差

#### 6.3.1 列车遮挡

相邻列车遮挡损耗：

```
L_shadowing = 10~20dB (取决于列车间距)
```

#### 6.3.2 隧道变形

隧道几何变化对定位精度的影响：

```
Δσ_pos = k × Δd_tunnel [m]

其中：
k = 敏感系数 = 0.3~0.8
Δd_tunnel = 隧道变形量
```

## 7. 系统优化

### 7.1 辐射单元优化配置

#### 7.1.1 功率分配

```
P_i = P_base × (1 + β×|x_i - x_center|/L_total)

其中：
P_base = 基准功率
β = 功率调节系数
x_center = 隧道中点位置
```

#### 7.1.2 频率规划

避免同频干扰的频率间隔：

```
Δf ≥ 2 × (Doppler_shift + Frequency_error)
```

### 7.2 算法优化

#### 7.2.1 卡尔曼滤波

状态方程：

```
X_k+1 = F × X_k + w_k
Z_k = H × X_k + v_k

其中：
X_k = [x, ẋ, y, ẏ]^T (位置和速度状态)
F = 状态转移矩阵
H = 观测矩阵
w_k, v_k = 过程噪声和观测噪声
```

#### 7.2.2 粒子滤波

非线性/非高斯情况下的定位：

```
p(x_k|z_1:k) ≈ Σ(i=1 to N) w_k^(i) × δ(x_k - x_k^(i))

其中：
x_k^(i) = 第i个粒子的状态
w_k^(i) = 第i个粒子的权重
```

## 8. 性能指标总结

### 8.1 定位精度指标

| 列车类型 | 长度 | 定位精度(95%) | 车头精度 | 车尾精度 |
| -------- | ---- | ------------- | -------- | -------- |
| 地铁列车 | 120m | ±1.5m         | ±1.2m    | ±1.8m    |
| 高速列车 | 200m | ±2.0m         | ±1.5m    | ±2.5m    |
| 货运列车 | 800m | ±3.5m         | ±2.0m    | ±5.0m    |

### 8.2 系统性能指标

| 指标     | 数值  | 备注         |
| -------- | ----- | ------------ |
| 覆盖率   | ≥96%  | RSSI≥-95dBm  |
| 可用性   | ≥95%  | 误差<5m      |
| 更新频率 | 20Hz  | 实时性要求   |
| 延迟     | <50ms | 端到端延迟   |
| 容量     | 8列车 | 同时定位数量 |

### 8.3 环境适应性

| 环境条件           | 影响程度 | 补偿措施     |
| ------------------ | -------- | ------------ |
| 温度变化(-20~60°C) | ±0.5m    | 温度补偿算法 |
| 湿度变化(20~95%RH) | ±0.3m    | 自适应门限   |
| 列车遮挡           | +2~5m    | 多径分集接收 |
| 漏缆老化           | +1~3m    | 定期校准     |

------

**注：本文档基于射线追踪理论和漏缆通信系统工程实践，提供了隧道长列车定位系统的完整数学建模和性能分析框架。实际系统实现时需要根据具体隧道环境和列车类型进行参数调优。**